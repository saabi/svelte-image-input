import{f as q,a as O}from"../chunks/C8nwTL5x.js";import{w as re,i as V,x as J,$ as se,aG as ie,h as T,y as ne,aH as oe,aI as le,aJ as ue,aK as fe,aL as ce,aM as ve,aE as de,c as C,aN as ge,a1 as H,u as E,B as l,aD as I,D as x,a2 as X,a3 as B,k as Q,a6 as M,a4 as D,a5 as S,aO as pe,ai as he}from"../chunks/B_w9vmgx.js";import{d as Z,e as Y,s as G}from"../chunks/BbTVkiE4.js";import{p as b,b as $,i as W}from"../chunks/Dz2eJi9S.js";import{o as me}from"../chunks/B1mtZjfV.js";function _e(e,t,r){re(()=>{var a=V(()=>t(e,r?.())||{});if(r&&a?.update){var s=!1,i={};J(()=>{var n=r();se(n),s&&ie(i,n)&&(i=n,a.update(n))}),s=!0}if(a?.destroy)return()=>a.destroy()})}function ee(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=ee(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function ye(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=ee(e))&&(a&&(a+=" "),a+=t);return a}function we(e){return typeof e=="object"?ye(e):e??""}function be(e,t,r){var a=e==null?"":""+e;return a=a?a+" "+t:t,a===""?null:a}function xe(e,t){return e==null?null:String(e)}function Ee(e,t,r,a,s,i){var n=e.__className;if(T||n!==r||n===void 0){var u=be(r,a);(!T||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):e.className=u),e.__className=r}return i}function Pe(e,t,r,a){var s=e.__style;if(T||s!==t){var i=xe(t);(!T||i!==e.getAttribute("style"))&&(i==null?e.removeAttribute("style"):e.style.cssText=i),e.__style=t}return a}const Le=Symbol("is custom element"),De=Symbol("is html");function Se(e){if(T){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var a=e.value;R(e,"value",null),e.value=a}if(e.hasAttribute("checked")){var s=e.checked;R(e,"checked",null),e.checked=s}}};e.__on_r=r,ne(r),oe()}}function R(e,t,r,a){var s=Ie(e);T&&(s[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||s[t]!==(s[t]=r)&&(t==="loading"&&(e[le]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Me(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function Ie(e){return e.__attributes??={[Le]:e.nodeName.includes("-"),[De]:e.namespaceURI===ue}}var z=new Map;function Me(e){var t=e.getAttribute("is")||e.nodeName,r=z.get(t);if(r)return r;z.set(t,r=[]);for(var a,s=e,i=Element.prototype;i!==s;){a=ce(s);for(var n in a)a[n].set&&r.push(n);s=fe(s)}return r}function Ae(e,t,r=t){var a=new WeakSet;ve(e,"input",async s=>{var i=s?e.defaultValue:e.value;if(i=U(e)?F(i):i,r(i),C!==null&&a.add(C),await de(),i!==(i=t())){var n=e.selectionStart,u=e.selectionEnd,y=e.value.length;if(e.value=i??"",u!==null){var _=e.value.length;n===u&&u===y&&_>y?(e.selectionStart=_,e.selectionEnd=_):(e.selectionStart=n,e.selectionEnd=Math.min(u,_))}}}),(T&&e.defaultValue!==e.value||V(t)==null&&e.value)&&(r(U(e)?F(e.value):e.value),C!==null&&a.add(C)),J(()=>{var s=t();if(e===document.activeElement){var i=ge??C;if(a.has(i))return}U(e)&&s===F(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function U(e){var t=e.type;return t==="number"||t==="range"}function F(e){return e===""?null:+e}function ke(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var N={},K;function Oe(){if(K)return N;K=1,Object.defineProperty(N,"__esModule",{value:!0});var e={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerover:"MSPointerOver",pointerout:"MSPointerOut",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",gotpointercapture:"MSGotPointerCapture",lostpointercapture:"MSLostPointerCapture",maxTouchPoints:"msMaxTouchPoints"},t={update:function(){typeof window<"u"&&("PointerEvent"in window?(t.hasApi=!0,t.requiresPrefix=!1):window.navigator&&"msPointerEnabled"in window.navigator?(t.hasApi=!0,t.requiresPrefix=!0):(t.hasApi=!1,t.requiresPrefix=void 0),t.maxTouchPoints=t.hasApi&&window.navigator&&window.navigator[t.prefix("maxTouchPoints")]||void 0,t.hasTouch=t.hasApi?t.maxTouchPoints>0:void 0)},prefix:function(a){return t.requiresPrefix&&e[a]||a}};return t.update(),N.default=t,N}var Te=Oe();const k=ke(Te);function qe(e){let t={};for(let r in e)t[r]=e[r];return t}function j(e,t,r,a){const s=e.getMinScale(),i=e.getScale();t<s&&(t=s);let n=e.getOffsetX(),u=e.getOffsetY();n=t*(n+r)/i-r,u=t*(u+a)/i-a,e.setOffsetX(n),e.setOffsetY(u),e.setScale(t)}function te(e,t,r){if(e.shiftKey)t||(t={x:e.offsetX,y:e.offsetY,s:r.getScale()}),j(r,t.s+(t.y-e.offsetY)/50,t.x,t.y);else{t=null;let a=r.getOffsetX(),s=r.getOffsetY();a-=e.movementX,s-=e.movementY,r.setOffsetX(a),r.setOffsetY(s)}return t}function Ce(e,t){function r(o){o.preventDefault(),o.stopPropagation();const g=Math.sign(o.deltaY);j(t,t.getScale()-g/10,o.offsetX,o.offsetY)}const a=[];function s(o){for(var g=0;g<a.length;g++)if(a[g].pointerId===o.pointerId){const v=qe(o);a[g]=v;break}g===a.length&&a.push(o)}function i(o){for(var g=0;g<a.length;g++)if(a[g].pointerId===o.pointerId){a.splice(g,1);break}}let n=null;function u(o){e.setPointerCapture(o.pointerId),t.getDragging()||(e.addEventListener(k.prefix("pointermove"),y,!0),t.setDragging(!0)),o.preventDefault(),o.stopPropagation(),s(o)}function y(o){if(a.length===1)n=te(o,n,t);else if(a.length===2){const v=a[0].offsetX,f=a[0].offsetY,d=a[1].offsetX,p=a[1].offsetY,c=o.offsetX,w=o.offsetY,h=v-d,P=f-p,A=Math.sqrt(h*h+P*P);let L,m;o.pointerId===a[0].pointerId?(L=c-d,m=w-p):(L=c-v,m=w-f);var g=Math.sqrt(L*L+m*m);j(t,t.getScale()*g/A,c,w)}o.preventDefault(),o.stopPropagation(),s(o)}function _(o){o.preventDefault(),o.stopPropagation(),i(o),e.releasePointerCapture(o.pointerId),a.length===0&&(t.setDragging(!1),e.removeEventListener(k.prefix("pointermove"),y,!0),n=null)}return e.addEventListener(k.prefix("pointerdown"),u,!0),e.addEventListener(k.prefix("pointerup"),_,!0),e.addEventListener("wheel",r,!0),{destroy:()=>{e.removeEventListener(k.prefix("pointerdown"),u,!0),e.removeEventListener(k.prefix("pointerup"),_,!0),e.removeEventListener("wheel",r,!0)}}}function Ye(e,t){function r(u){u.preventDefault(),u.stopPropagation();const y=Math.sign(u.deltaY);j(t,t.getScale()-y/10,u.offsetX,u.offsetY)}let a=null;function s(u){typeof e.setCapture=="function"&&e.setCapture(),t.getDragging()||(e.addEventListener("mousemove",i,!0),window.addEventListener("mouseup",n,!0),t.setDragging(!0)),u.preventDefault(),u.stopPropagation()}function i(u){a=te(u,a,t),u.preventDefault(),u.stopPropagation()}function n(u){u.preventDefault(),u.stopPropagation(),typeof e.releaseCapture=="function"&&e.releaseCapture(),t.setDragging(!1),e.removeEventListener("mousemove",i,!0),window.removeEventListener("mouseup",n,!0),a=null}return e.addEventListener("mousedown",s,!0),e.addEventListener("mouseup",n,!0),e.addEventListener("wheel",r,!0),{destroy:()=>{e.removeEventListener("mousedown",s,!0),e.removeEventListener("mouseup",n,!0),e.removeEventListener("wheel",r,!0)}}}const Xe=!!globalThis.window,Re=Xe&&!!k.maxTouchPoints,Ne=Re?Ce:Ye;var je=q("<canvas></canvas>");function Ue(e,t){H(t,!0);let r=b(t,"src",15),a=b(t,"url",15),s=b(t,"quality",15),i=b(t,"width",15),n=b(t,"height",15),u=b(t,"realTime",15),y=b(t,"crossOrigin",15),_=b(t,"classes",15),o=b(t,"showCompressedResult",15),g=I(void 0),v=I(void 0),f,d=I(0),p=I(0),c=I(1),w=I(1),h=I(!1),P={getMinScale(){return l(w)},getScale(){return l(c)},setScale(m){x(c,m,!0)},getOffsetX(){return l(d)},getOffsetY(){return l(p)},setOffsetX(m){x(d,m,!0)},setOffsetY(m){x(p,m,!0)},setDragging(m){!u()&&m===!1&&a(l(g).toDataURL("image/jpeg",s())),x(h,m,!0)},getDragging(){return l(h)}};E(()=>{i(i()??256)}),E(()=>{n(n()??256)}),E(()=>{r(r()||"")}),E(()=>{a(a()||"")}),E(()=>{i(i()||256)}),E(()=>{n(n()||256)}),E(()=>{s(s()||.5)}),E(()=>{u(u()||!1)}),E(()=>{y(y()||!1)}),E(()=>{_(_()||"")}),E(()=>{o(o()||!1)}),E(()=>{l(v)&&(l(v).crossOrigin=y()?"anonymous":null)}),E(()=>{l(v)&&(l(v).src=r())}),E(()=>{s(),i(),n(),l(d),l(p),l(c),A()}),me(()=>{f=l(g).getContext("2d"),x(v,new Image,!0),l(v).onload=function(){x(d,0),x(p,0),x(c,x(w,Math.max(i()/l(v).width,n()/l(v).height),!0),!0)}});function A(){if(!l(v)||!f)return;l(d)<0&&x(d,0),l(p)<0&&x(p,0);let m=l(v).width*l(c)-i();l(d)>m&&x(d,m,!0),m=l(v).height*l(c)-n(),l(p)>m&&x(p,m,!0),f.resetTransform(),f.clearRect(0,0,i(),n()),f.translate(-l(d),-l(p)),f.scale(l(c),l(c)),f.drawImage(l(v),0,0),(u()||!l(h))&&a(l(g).toDataURL("image/jpeg",s()))}var L=je();$(L,m=>x(g,m),()=>l(g)),_e(L,(m,ae)=>Ne?.(m,ae),()=>P),X(()=>{R(L,"width",i()),R(L,"height",n()),Ee(L,1,we(_()),"svelte-1sswqpx")}),O(e,L),B()}var Fe=q('<div class="drop-area svelte-186px3q">Drop, paste, or <button class="svelte-186px3q">load an image</button></div> <input type="file" accept="image/*" class="hidden svelte-186px3q"/>',1);function We(e,t){H(t,!0);let r=I(void 0);const a=f=>{f.preventDefault()},s=f=>{const d=new FileReader;d.onload=p=>{if(!p.target)return;const c=p.target.result;t.onImageLoaded?.(c)},d.readAsDataURL(f)},i=f=>{const d=f.target?.files?.[0];d&&s(d)},n=f=>{f.preventDefault();const d=f.dataTransfer?.items;if(!d)return;const p=Array.from(d).find(w=>w.kind==="file"&&w.type.startsWith("image/"));if(!p)return;const c=p.getAsFile();c&&s(c)},u=async f=>{const d=f.clipboardData?.items;if(!d)return;const p=Array.from(d).find(w=>w.type.indexOf("image")===0);if(!p)return;f.preventDefault();const c=p.getAsFile();c&&s(c)},y=()=>{l(r).click()};var _=Fe();Y("paste",pe,u);var o=Q(_),g=M(D(o));g.__click=y,S(o);var v=M(o,2);v.__change=i,$(v,f=>x(r,f),()=>l(r)),Y("drop",o,n),Y("dragover",o,a),Y("dragenter",o,a),Y("dragleave",o,a),O(e,_),B()}Z(["click","change"]);var He=q('<!> <button class="svelte-huqjm5">X</button>',1),Be=q('<div class="ImageInput svelte-huqjm5"><!></div>');function Ge(e,t){H(t,!0);let r=b(t,"classes",3,""),a=b(t,"crossOrigin",3,!1),s=b(t,"src",15,""),i=b(t,"width",15),n=b(t,"height",15),u=b(t,"quality",3,.5),y=b(t,"realTime",3,!1),_=b(t,"url",15,""),o=b(t,"showCompressedResult",3,!1);E(()=>{i(i()??256)}),E(()=>{n(n()??256)});const g=()=>{s(""),_("")};var v=Be(),f=D(v);{var d=c=>{var w=He(),h=Q(w);Ue(h,{get classes(){return r()},get crossOrigin(){return a()},get height(){return n()},get realTime(){return y()},get src(){return s()},get showCompressedResult(){return o()},get quality(){return u()},get width(){return i()},get url(){return _()},set url(A){_(A)}});var P=M(h,2);P.__click=g,O(c,w)},p=c=>{We(c,{onImageLoaded:w=>s(w)})};W(f,c=>{s()?c(d):c(p,!1)})}S(v),X(()=>Pe(v,`--image-input-width: ${i()??""}px; --image-input-height: ${n()??""}px`)),O(e,v),B()}Z(["click"]);var ze=q('<img alt="sample output"/>'),Ke=q('<p class="svelte-1uha8ag"> </p>'),Ve=q(`<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Svelte Image Input and Manipulation Components</h1> <h2 class="svelte-1uha8ag">ImageInput Example</h2> <p class="svelte-1uha8ag">Load an image using drag and drop, clipboard paste, or by clicking the
		"Load an image" button. Then, resize and crop the image. The output
		image will be displayed beside along with the final size in bytes of the
		data URL.</p> <label><span> </span> <input type="range" min="0.1" max="1" step="0.1"/></label> <div class="demo svelte-1uha8ag"><div class="input"><h3 class="svelte-1uha8ag">Input Image</h3> <div class="imagebox svelte-1uha8ag"><!></div></div> <div class="output"><h3 class="svelte-1uha8ag">Output Image</h3> <div class="imagebox svelte-1uha8ag"><!></div> <!></div></div> <p class="svelte-1uha8ag">Check out the code on <a href="https://github.com/saabi/svelte-image-input" target="_blank" rel="noopener noreferrer" class="svelte-1uha8ag">GitHub</a>.</p></div>`);function tt(e){let t=I(""),r=I(.9);var a=Ve(),s=M(D(a),6),i=D(s),n=D(i);S(i);var u=M(i,2);Se(u),S(s);var y=M(s,2),_=D(y),o=M(D(_),2),g=D(o);Ge(g,{get quality(){return l(r)},get url(){return l(t)},set url(h){x(t,h,!0)}}),S(o),S(_);var v=M(_,2),f=M(D(v),2),d=D(f);{var p=h=>{var P=ze();X(()=>R(P,"src",l(t))),O(h,P)};W(d,h=>{l(t)&&h(p)})}S(f);var c=M(f,2);{var w=h=>{var P=Ke(),A=D(P);S(P),X(()=>G(A,`data url size: ${l(t).length??""} bytes`)),O(h,P)};W(c,h=>{l(t)&&h(w)})}S(v),S(y),he(2),S(a),X(h=>G(n,`Quality (${h??""}%):`),[()=>Math.round(l(r)*100)]),Ae(u,()=>l(r),h=>x(r,h)),O(e,a)}export{tt as component};
